<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.github.hualuomoli.plugin.roll.mapper.DefaultRollMapper">

  <update id="lock">
    UPDATE `pr_poll_frequency` a
	SET a.lock_string = #{lockString}, 	/** 锁定字符串 */
	a.un_lock_time = #{lockTime}		/** 锁定时间    */
	WHERE a.execute_time <![CDATA[<]]> #{executeTime}	/** 可执行时间 */
	AND (
		a.lock_string = #{unLockStr}					/** 未锁定 */
		OR a.un_lock_time <![CDATA[<]]> #{executeTime}	/** 锁定时间超时 */
	)
	ORDER BY a.priority, a.execute_time
	LIMIT ${count}
  </update>
  
</mapper>